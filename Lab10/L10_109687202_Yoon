-- ***********************
-- Student Name: Jeongseon Yoon
-- Student ID: 109687202
-- Date: August 10th, 2021
-- Purpose: Lab 10 - DBS311NDD
-- ***********************

Q1.
> db.grades.aggregate({"$sort": {"student_id": -1, "class_id": 1}}, {"$project": {"student_id": 1, "class_id": 1, "_id": 0} })
{ "student_id" : 49, "class_id" : 29 }
{ "student_id" : 48, "class_id" : 2 }
{ "student_id" : 48, "class_id" : 8 }
{ "student_id" : 48, "class_id" : 10 }
{ "student_id" : 48, "class_id" : 14 }
{ "student_id" : 48, "class_id" : 15 }
{ "student_id" : 47, "class_id" : 22 }
{ "student_id" : 46, "class_id" : 3 }
{ "student_id" : 46, "class_id" : 20 }
{ "student_id" : 45, "class_id" : 5 }
{ "student_id" : 45, "class_id" : 6 }
{ "student_id" : 45, "class_id" : 13 }
{ "student_id" : 45, "class_id" : 25 }
{ "student_id" : 45, "class_id" : 29 }
{ "student_id" : 44, "class_id" : 1 }
{ "student_id" : 44, "class_id" : 7 }
{ "student_id" : 44, "class_id" : 11 }
{ "student_id" : 44, "class_id" : 21 }
{ "student_id" : 43, "class_id" : 2 }
{ "student_id" : 43, "class_id" : 10 }
Type "it" for more
> it
{ "student_id" : 43, "class_id" : 11 }
{ "student_id" : 43, "class_id" : 15 }
{ "student_id" : 43, "class_id" : 18 }
{ "student_id" : 43, "class_id" : 22 }
{ "student_id" : 43, "class_id" : 23 }
{ "student_id" : 43, "class_id" : 27 }
{ "student_id" : 43, "class_id" : 28 }
{ "student_id" : 42, "class_id" : 5 }
{ "student_id" : 42, "class_id" : 14 }
{ "student_id" : 42, "class_id" : 18 }
{ "student_id" : 42, "class_id" : 26 }
{ "student_id" : 41, "class_id" : 0 }
{ "student_id" : 41, "class_id" : 3 }
{ "student_id" : 41, "class_id" : 5 }
{ "student_id" : 41, "class_id" : 10 }
{ "student_id" : 41, "class_id" : 15 }
{ "student_id" : 41, "class_id" : 17 }
{ "student_id" : 41, "class_id" : 18 }
{ "student_id" : 41, "class_id" : 19 }
{ "student_id" : 41, "class_id" : 20 }
Type "it" for more
> it
{ "student_id" : 41, "class_id" : 30 }
{ "student_id" : 40, "class_id" : 1 }
{ "student_id" : 40, "class_id" : 2 }
{ "student_id" : 40, "class_id" : 10 }
{ "student_id" : 40, "class_id" : 14 }
{ "student_id" : 40, "class_id" : 15 }
{ "student_id" : 40, "class_id" : 16 }
{ "student_id" : 40, "class_id" : 18 }
{ "student_id" : 40, "class_id" : 19 }
{ "student_id" : 40, "class_id" : 22 }
{ "student_id" : 40, "class_id" : 24 }
{ "student_id" : 40, "class_id" : 30 }
{ "student_id" : 39, "class_id" : 3 }
{ "student_id" : 39, "class_id" : 8 }
{ "student_id" : 39, "class_id" : 9 }
{ "student_id" : 39, "class_id" : 15 }
{ "student_id" : 39, "class_id" : 18 }
{ "student_id" : 39, "class_id" : 22 }
{ "student_id" : 39, "class_id" : 23 }
{ "student_id" : 39, "class_id" : 27 }
Type "it" for more
> it
{ "student_id" : 39, "class_id" : 28 }
{ "student_id" : 38, "class_id" : 0 }
{ "student_id" : 38, "class_id" : 17 }
{ "student_id" : 38, "class_id" : 23 }
{ "student_id" : 38, "class_id" : 26 }
{ "student_id" : 38, "class_id" : 30 }
{ "student_id" : 37, "class_id" : 3 }
{ "student_id" : 37, "class_id" : 4 }
{ "student_id" : 37, "class_id" : 7 }
{ "student_id" : 37, "class_id" : 16 }
{ "student_id" : 37, "class_id" : 19 }
{ "student_id" : 37, "class_id" : 25 }
{ "student_id" : 37, "class_id" : 26 }
{ "student_id" : 37, "class_id" : 28 }
{ "student_id" : 36, "class_id" : 6 }
{ "student_id" : 36, "class_id" : 10 }
{ "student_id" : 36, "class_id" : 14 }
{ "student_id" : 36, "class_id" : 23 }
{ "student_id" : 35, "class_id" : 18 }
{ "student_id" : 35, "class_id" : 22 }
Type "it" for more
> it
{ "student_id" : 34, "class_id" : 7 }
{ "student_id" : 34, "class_id" : 10 }
{ "student_id" : 34, "class_id" : 25 }
{ "student_id" : 34, "class_id" : 26 }
{ "student_id" : 34, "class_id" : 27 }
{ "student_id" : 34, "class_id" : 28 }
{ "student_id" : 33, "class_id" : 1 }
{ "student_id" : 33, "class_id" : 5 }
{ "student_id" : 33, "class_id" : 12 }
{ "student_id" : 33, "class_id" : 15 }
{ "student_id" : 33, "class_id" : 23 }
{ "student_id" : 33, "class_id" : 30 }
{ "student_id" : 32, "class_id" : 2 }
{ "student_id" : 32, "class_id" : 16 }
{ "student_id" : 32, "class_id" : 22 }
{ "student_id" : 32, "class_id" : 23 }
{ "student_id" : 32, "class_id" : 24 }
{ "student_id" : 32, "class_id" : 29 }
{ "student_id" : 31, "class_id" : 0 }
{ "student_id" : 31, "class_id" : 1 }
Type "it" for more
> it
{ "student_id" : 31, "class_id" : 2 }
{ "student_id" : 31, "class_id" : 19 }
{ "student_id" : 30, "class_id" : 0 }
{ "student_id" : 30, "class_id" : 2 }
{ "student_id" : 30, "class_id" : 3 }
{ "student_id" : 30, "class_id" : 4 }
{ "student_id" : 30, "class_id" : 6 }
{ "student_id" : 30, "class_id" : 7 }
{ "student_id" : 30, "class_id" : 15 }
{ "student_id" : 30, "class_id" : 16 }
{ "student_id" : 30, "class_id" : 17 }
{ "student_id" : 30, "class_id" : 25 }
{ "student_id" : 30, "class_id" : 29 }
{ "student_id" : 29, "class_id" : 1 }
{ "student_id" : 29, "class_id" : 4 }
{ "student_id" : 29, "class_id" : 6 }
{ "student_id" : 29, "class_id" : 7 }
{ "student_id" : 29, "class_id" : 9 }
{ "student_id" : 29, "class_id" : 11 }
{ "student_id" : 29, "class_id" : 12 }
Type "it" for more
> it
{ "student_id" : 29, "class_id" : 16 }
{ "student_id" : 29, "class_id" : 22 }
{ "student_id" : 29, "class_id" : 28 }
{ "student_id" : 28, "class_id" : 5 }
{ "student_id" : 28, "class_id" : 23 }
{ "student_id" : 28, "class_id" : 29 }
{ "student_id" : 27, "class_id" : 9 }
{ "student_id" : 27, "class_id" : 27 }
{ "student_id" : 26, "class_id" : 6 }
{ "student_id" : 26, "class_id" : 12 }
{ "student_id" : 26, "class_id" : 25 }
{ "student_id" : 25, "class_id" : 0 }
{ "student_id" : 25, "class_id" : 2 }
{ "student_id" : 25, "class_id" : 7 }
{ "student_id" : 25, "class_id" : 15 }
{ "student_id" : 25, "class_id" : 18 }
{ "student_id" : 25, "class_id" : 19 }
{ "student_id" : 24, "class_id" : 2 }
{ "student_id" : 24, "class_id" : 14 }
{ "student_id" : 24, "class_id" : 22 }
Type "it" for more
> it
{ "student_id" : 24, "class_id" : 23 }
{ "student_id" : 24, "class_id" : 26 }
{ "student_id" : 23, "class_id" : 3 }
{ "student_id" : 23, "class_id" : 7 }
{ "student_id" : 23, "class_id" : 8 }
{ "student_id" : 23, "class_id" : 10 }
{ "student_id" : 23, "class_id" : 11 }
{ "student_id" : 23, "class_id" : 17 }
{ "student_id" : 23, "class_id" : 18 }
{ "student_id" : 23, "class_id" : 20 }
{ "student_id" : 23, "class_id" : 24 }
{ "student_id" : 23, "class_id" : 27 }
{ "student_id" : 22, "class_id" : 1 }
{ "student_id" : 22, "class_id" : 8 }
{ "student_id" : 22, "class_id" : 19 }
{ "student_id" : 21, "class_id" : 10 }
{ "student_id" : 21, "class_id" : 11 }
{ "student_id" : 21, "class_id" : 22 }
{ "student_id" : 21, "class_id" : 25 }
{ "student_id" : 21, "class_id" : 26 }
Type "it" for more
> it
{ "student_id" : 21, "class_id" : 30 }
{ "student_id" : 20, "class_id" : 1 }
{ "student_id" : 20, "class_id" : 3 }
{ "student_id" : 20, "class_id" : 6 }
{ "student_id" : 20, "class_id" : 12 }
{ "student_id" : 20, "class_id" : 16 }
{ "student_id" : 20, "class_id" : 25 }
{ "student_id" : 20, "class_id" : 26 }
{ "student_id" : 20, "class_id" : 29 }
{ "student_id" : 20, "class_id" : 30 }
{ "student_id" : 19, "class_id" : 22 }
{ "student_id" : 19, "class_id" : 29 }
{ "student_id" : 18, "class_id" : 3 }
{ "student_id" : 18, "class_id" : 4 }
{ "student_id" : 18, "class_id" : 5 }
{ "student_id" : 18, "class_id" : 8 }
{ "student_id" : 18, "class_id" : 12 }
{ "student_id" : 18, "class_id" : 16 }
{ "student_id" : 18, "class_id" : 20 }
{ "student_id" : 18, "class_id" : 21 }
Type "it" for more
> it
{ "student_id" : 18, "class_id" : 23 }
{ "student_id" : 17, "class_id" : 19 }
{ "student_id" : 17, "class_id" : 30 }
{ "student_id" : 16, "class_id" : 9 }
{ "student_id" : 16, "class_id" : 15 }
{ "student_id" : 15, "class_id" : 0 }
{ "student_id" : 15, "class_id" : 6 }
{ "student_id" : 15, "class_id" : 11 }
{ "student_id" : 15, "class_id" : 14 }
{ "student_id" : 15, "class_id" : 17 }
{ "student_id" : 15, "class_id" : 18 }
{ "student_id" : 15, "class_id" : 21 }
{ "student_id" : 15, "class_id" : 22 }
{ "student_id" : 15, "class_id" : 24 }
{ "student_id" : 15, "class_id" : 27 }
{ "student_id" : 14, "class_id" : 6 }
{ "student_id" : 14, "class_id" : 7 }
{ "student_id" : 14, "class_id" : 11 }
{ "student_id" : 14, "class_id" : 17 }
{ "student_id" : 14, "class_id" : 20 }
Type "it" for more
> it
{ "student_id" : 13, "class_id" : 22 }
{ "student_id" : 12, "class_id" : 3 }
{ "student_id" : 12, "class_id" : 4 }
{ "student_id" : 12, "class_id" : 10 }
{ "student_id" : 12, "class_id" : 11 }
{ "student_id" : 12, "class_id" : 13 }
{ "student_id" : 12, "class_id" : 21 }
{ "student_id" : 12, "class_id" : 23 }
{ "student_id" : 12, "class_id" : 27 }
{ "student_id" : 11, "class_id" : 24 }
{ "student_id" : 11, "class_id" : 25 }
{ "student_id" : 10, "class_id" : 5 }
{ "student_id" : 9, "class_id" : 0 }
{ "student_id" : 9, "class_id" : 3 }
{ "student_id" : 9, "class_id" : 5 }
{ "student_id" : 9, "class_id" : 8 }
{ "student_id" : 9, "class_id" : 9 }
{ "student_id" : 9, "class_id" : 10 }
{ "student_id" : 9, "class_id" : 14 }
{ "student_id" : 9, "class_id" : 15 }
Type "it" for more
> it
{ "student_id" : 9, "class_id" : 16 }
{ "student_id" : 9, "class_id" : 17 }
{ "student_id" : 9, "class_id" : 30 }
{ "student_id" : 8, "class_id" : 0 }
{ "student_id" : 8, "class_id" : 4 }
{ "student_id" : 8, "class_id" : 11 }
{ "student_id" : 8, "class_id" : 13 }
{ "student_id" : 8, "class_id" : 20 }
{ "student_id" : 8, "class_id" : 29 }
{ "student_id" : 7, "class_id" : 17 }
{ "student_id" : 6, "class_id" : 8 }
{ "student_id" : 6, "class_id" : 9 }
{ "student_id" : 6, "class_id" : 17 }
{ "student_id" : 6, "class_id" : 20 }
{ "student_id" : 6, "class_id" : 21 }
{ "student_id" : 6, "class_id" : 22 }
{ "student_id" : 6, "class_id" : 28 }
{ "student_id" : 6, "class_id" : 29 }
{ "student_id" : 5, "class_id" : 0 }
{ "student_id" : 5, "class_id" : 8 }
Type "it" for more
> it
{ "student_id" : 5, "class_id" : 16 }
{ "student_id" : 5, "class_id" : 18 }
{ "student_id" : 5, "class_id" : 19 }
{ "student_id" : 5, "class_id" : 23 }
{ "student_id" : 5, "class_id" : 30 }
{ "student_id" : 4, "class_id" : 0 }
{ "student_id" : 4, "class_id" : 5 }
{ "student_id" : 4, "class_id" : 8 }
{ "student_id" : 4, "class_id" : 12 }
{ "student_id" : 4, "class_id" : 19 }
{ "student_id" : 4, "class_id" : 24 }
{ "student_id" : 4, "class_id" : 26 }
{ "student_id" : 3, "class_id" : 3 }
{ "student_id" : 3, "class_id" : 7 }
{ "student_id" : 3, "class_id" : 9 }
{ "student_id" : 3, "class_id" : 10 }
{ "student_id" : 3, "class_id" : 11 }
{ "student_id" : 3, "class_id" : 12 }
{ "student_id" : 3, "class_id" : 13 }
{ "student_id" : 3, "class_id" : 16 }
Type "it" for more
> it
{ "student_id" : 3, "class_id" : 25 }
{ "student_id" : 2, "class_id" : 24 }
{ "student_id" : 2, "class_id" : 25 }
{ "student_id" : 2, "class_id" : 27 }
{ "student_id" : 1, "class_id" : 13 }
{ "student_id" : 1, "class_id" : 16 }
{ "student_id" : 1, "class_id" : 18 }
{ "student_id" : 1, "class_id" : 22 }
{ "student_id" : 1, "class_id" : 28 }
{ "student_id" : 0, "class_id" : 2 }
{ "student_id" : 0, "class_id" : 5 }
{ "student_id" : 0, "class_id" : 6 }
{ "student_id" : 0, "class_id" : 7 }
{ "student_id" : 0, "class_id" : 10 }
{ "student_id" : 0, "class_id" : 11 }
{ "student_id" : 0, "class_id" : 16 }
{ "student_id" : 0, "class_id" : 24 }
{ "student_id" : 0, "class_id" : 27 }
{ "student_id" : 0, "class_id" : 28 }
{ "student_id" : 0, "class_id" : 30 }


Q2.
> db.grades.aggregate({ $match: {"student_id" : {"$gte": 10, "$lte": 12}}}, {"$sort": {"student_id": 1, "class_id": -1}}, {"$project": {"student_id": 1, "class_id": 1, "_id": 0} })
{ "student_id" : 10, "class_id" : 5 }
{ "student_id" : 11, "class_id" : 25 }
{ "student_id" : 11, "class_id" : 24 }
{ "student_id" : 12, "class_id" : 27 }
{ "student_id" : 12, "class_id" : 23 }
{ "student_id" : 12, "class_id" : 21 }
{ "student_id" : 12, "class_id" : 13 }
{ "student_id" : 12, "class_id" : 11 }
{ "student_id" : 12, "class_id" : 10 }
{ "student_id" : 12, "class_id" : 4 }
{ "student_id" : 12, "class_id" : 3 }


Q3.
> db.grades.aggregate({ $group: { _id : "$class_id"}}, {"$project": {"class_id": "$_id", "_id": 0}})
{ "class_id" : 14 }
{ "class_id" : 11 }
{ "class_id" : 5 }
{ "class_id" : 25 }
{ "class_id" : 18 }
{ "class_id" : 30 }
{ "class_id" : 10 }
{ "class_id" : 4 }
{ "class_id" : 24 }
{ "class_id" : 21 }
{ "class_id" : 8 }
{ "class_id" : 7 }
{ "class_id" : 13 }
{ "class_id" : 2 }
{ "class_id" : 3 }
{ "class_id" : 1 }
{ "class_id" : 26 }
{ "class_id" : 28 }
{ "class_id" : 27 }
{ "class_id" : 12 }
Type "it" for more
> it
{ "class_id" : 29 }
{ "class_id" : 6 }
{ "class_id" : 0 }
{ "class_id" : 19 }
{ "class_id" : 23 }
{ "class_id" : 22 }
{ "class_id" : 16 }
{ "class_id" : 9 }
{ "class_id" : 17 }
{ "class_id" : 20 }
{ "class_id" : 15 }
>

Q4.
> db.grades.aggregate({ $match: {"scores.score" : {"$gt": 99}}}, {"$sort": {"student_id": -1, "class_id": 1}}, {"$project": {"student_id": 1, "class_id": 1, "_id": 0} })
{ "student_id" : 44, "class_id" : 7 }
{ "student_id" : 44, "class_id" : 11 }
{ "student_id" : 43, "class_id" : 27 }
{ "student_id" : 42, "class_id" : 14 }
{ "student_id" : 41, "class_id" : 19 }
{ "student_id" : 21, "class_id" : 25 }
{ "student_id" : 21, "class_id" : 30 }
{ "student_id" : 14, "class_id" : 6 }
{ "student_id" : 14, "class_id" : 20 }
{ "student_id" : 12, "class_id" : 27 }
{ "student_id" : 3, "class_id" : 11 }


Q5.
> db.grades.aggregate({ $group: { _id : "$student_id", "max_class_id": {"$max": "$class_id"}, "min_class_id": {"$min": "$class_id"}}}, {"$sort": {"_id": 1}}, {"$limit":10})
{ "_id" : 0, "max_class_id" : 30, "min_class_id" : 2 }
{ "_id" : 1, "max_class_id" : 28, "min_class_id" : 13 }
{ "_id" : 2, "max_class_id" : 27, "min_class_id" : 24 }
{ "_id" : 3, "max_class_id" : 25, "min_class_id" : 3 }
{ "_id" : 4, "max_class_id" : 26, "min_class_id" : 0 }
{ "_id" : 5, "max_class_id" : 30, "min_class_id" : 0 }
{ "_id" : 6, "max_class_id" : 29, "min_class_id" : 8 }
{ "_id" : 7, "max_class_id" : 17, "min_class_id" : 17 }
{ "_id" : 8, "max_class_id" : 29, "min_class_id" : 0 }
{ "_id" : 9, "max_class_id" : 30, "min_class_id" : 0 }

Q6.
> db.grades.aggregate([{ $unwind: '$scores'}, { $match: {"student_id" : 48, "scores.score" : {"$lt": 50}}}, {$count: "failed exams"}])
{ "failed exams" : 12 }